

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>techminer.dataframe &mdash; TechMiner - A Package for Bibliographical Analysis using Python 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> TechMiner - A Package for Bibliographical Analysis using Python
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorial</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TechMiner - A Package for Bibliographical Analysis using Python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>techminer.dataframe</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for techminer.dataframe</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">DataFrame object</span>
<span class="sd">==================================================================================================</span>




<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">.keywords</span> <span class="kn">import</span> <span class="n">Keywords</span>
<span class="kn">from</span> <span class="nn">.strings</span> <span class="kn">import</span> <span class="n">remove_accents</span>

<span class="n">SCOPUS_SEPS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Authors&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Author(s) ID&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Author Keywords&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Index Keywords&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Keywords&quot;</span><span class="p">:</span> <span class="s2">&quot;;&quot;</span><span class="p">,</span>
<span class="p">}</span>


<div class="viewcode-block" id="relationship"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.relationship">[docs]</a><span class="k">def</span> <span class="nf">relationship</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">sxy</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">*</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">sxy</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="heatmap"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.heatmap">[docs]</a><span class="k">def</span> <span class="nf">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Blues&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display the dataframe as a heatmap in Jupyter.</span>

<span class="sd">        Args:</span>
<span class="sd">            df (pandas.DataFrame): dataframe as a matrix.</span>
<span class="sd">            cmap (colormap): colormap used to build a heatmap.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame. Exploded dataframe.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span></div>


<div class="viewcode-block" id="sort_by_numdocuments"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.sort_by_numdocuments">[docs]</a><span class="k">def</span> <span class="nf">sort_by_numdocuments</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;quicksort&quot;</span><span class="p">,</span> <span class="n">axis_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_sep</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sorts a matrix axis by the number of documents.</span>


<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): dataframe with bibliographic information.</span>
<span class="sd">        matrix (pandas.DataFrame): matrix to sort.</span>
<span class="sd">        axis ({0 or ‘index’, 1 or ‘columns’}), default 0: axis to be sorted.</span>
<span class="sd">        ascending (bool): sort ascending?.</span>
<span class="sd">        kind (str): ‘quicksort’, ‘mergesort’, ‘heapsort’.</span>
<span class="sd">        axis_name (str): column name used to sort by number of documents.</span>
<span class="sd">        axis_sep (str): character used to separate the internal values of column axis_name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame sorted.</span>

<span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">    &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">    ...     {</span>
<span class="sd">    ...         &quot;c0&quot;: [&quot;D&quot;] * 4 + [&quot;B&quot;] * 3 + [&quot;C&quot;] * 2 + [&quot;A&quot;],</span>
<span class="sd">    ...         &quot;c1&quot;: [&quot;a&quot;] * 4 + [&quot;c&quot;] * 3 + [&quot;b&quot;] * 2 + [&quot;d&quot;],</span>
<span class="sd">    ...         &quot;Cited by&quot;: list(range(10)),</span>
<span class="sd">    ...         &quot;ID&quot;: list(range(10)),</span>
<span class="sd">    ...     },</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; df</span>
<span class="sd">      c0 c1  Cited by  ID</span>
<span class="sd">    0  D  a         0   0</span>
<span class="sd">    1  D  a         1   1</span>
<span class="sd">    2  D  a         2   2</span>
<span class="sd">    3  D  a         3   3</span>
<span class="sd">    4  B  c         4   4</span>
<span class="sd">    5  B  c         5   5</span>
<span class="sd">    6  B  c         6   6</span>
<span class="sd">    7  C  b         7   7</span>
<span class="sd">    8  C  b         8   8</span>
<span class="sd">    9  A  d         9   9</span>

<span class="sd">    &gt;&gt;&gt; matrix = pd.DataFrame(</span>
<span class="sd">    ...     {&quot;D&quot;: [0, 1, 2, 3], &quot;B&quot;: [4, 5, 6, 7], &quot;A&quot;: [8, 9, 10, 11], &quot;C&quot;: [12, 13, 14, 15],},</span>
<span class="sd">    ...     index=list(&quot;badc&quot;),</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; matrix</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    a  1  5   9  13</span>
<span class="sd">    d  2  6  10  14</span>
<span class="sd">    c  3  7  11  15</span>

<span class="sd">    &gt;&gt;&gt; sort_by_numdocuments(df, matrix, axis=&#39;columns&#39;, ascending=True, axis_name=&#39;c0&#39;)</span>
<span class="sd">        A  B   C  D</span>
<span class="sd">    b   8  4  12  0</span>
<span class="sd">    a   9  5  13  1</span>
<span class="sd">    d  10  6  14  2</span>
<span class="sd">    c  11  7  15  3</span>

<span class="sd">    &gt;&gt;&gt; sort_by_numdocuments(df, matrix, axis=&#39;columns&#39;, ascending=False, axis_name=&#39;c0&#39;)</span>
<span class="sd">       D   C  B   A</span>
<span class="sd">    b  0  12  4   8</span>
<span class="sd">    a  1  13  5   9</span>
<span class="sd">    d  2  14  6  10</span>
<span class="sd">    c  3  15  7  11</span>

<span class="sd">    &gt;&gt;&gt; sort_by_numdocuments(df, matrix, axis=&#39;index&#39;, ascending=True, axis_name=&#39;c1&#39;)</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    a  1  5   9  13</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    c  3  7  11  15</span>
<span class="sd">    d  2  6  10  14</span>

<span class="sd">    &gt;&gt;&gt; sort_by_numdocuments(df, matrix, axis=&#39;index&#39;, ascending=False, axis_name=&#39;c1&#39;)</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    d  2  6  10  14</span>
<span class="sd">    c  3  7  11  15</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    a  1  5   9  13</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">documents_by_term</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">axis_name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">axis_sep</span><span class="p">)</span>
    <span class="n">terms_sorted</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">terms</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">axis_name</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">terms_sorted</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">terms_sorted</span><span class="p">]</span></div>


<div class="viewcode-block" id="sort_by_citations"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.sort_by_citations">[docs]</a><span class="k">def</span> <span class="nf">sort_by_citations</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;quicksort&quot;</span><span class="p">,</span> <span class="n">axis_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis_sep</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sorts a matrix axis by the citations.</span>


<span class="sd">    Args:</span>
<span class="sd">        df (pandas.DataFrame): dataframe with bibliographic information.</span>
<span class="sd">        matrix (pandas.DataFrame): matrix to sort.</span>
<span class="sd">        axis ({0 or ‘index’, 1 or ‘columns’}), default 0: axis to be sorted.</span>
<span class="sd">        ascending (bool): sort ascending?.</span>
<span class="sd">        kind (str): ‘quicksort’, ‘mergesort’, ‘heapsort’.</span>
<span class="sd">        axis_name (str): column name used to sort by citations.</span>
<span class="sd">        axis_sep (str): character used to separate the internal values of column axis_name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame sorted.</span>

<span class="sd">    &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">    &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">    ...     {</span>
<span class="sd">    ...         &quot;c0&quot;: [&quot;D&quot;] * 4 + [&quot;B&quot;] * 3 + [&quot;C&quot;] * 2 + [&quot;A&quot;],</span>
<span class="sd">    ...         &quot;c1&quot;: [&quot;a&quot;] * 4 + [&quot;c&quot;] * 3 + [&quot;b&quot;] * 2 + [&quot;d&quot;],</span>
<span class="sd">    ...         &quot;Cited by&quot;: list(range(10)),</span>
<span class="sd">    ...         &quot;ID&quot;: list(range(10)),</span>
<span class="sd">    ...     },</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; df</span>
<span class="sd">      c0 c1  Cited by  ID</span>
<span class="sd">    0  D  a         0   0</span>
<span class="sd">    1  D  a         1   1</span>
<span class="sd">    2  D  a         2   2</span>
<span class="sd">    3  D  a         3   3</span>
<span class="sd">    4  B  c         4   4</span>
<span class="sd">    5  B  c         5   5</span>
<span class="sd">    6  B  c         6   6</span>
<span class="sd">    7  C  b         7   7</span>
<span class="sd">    8  C  b         8   8</span>
<span class="sd">    9  A  d         9   9</span>

<span class="sd">    &gt;&gt;&gt; matrix = pd.DataFrame(</span>
<span class="sd">    ...     {&quot;D&quot;: [0, 1, 2, 3], &quot;B&quot;: [4, 5, 6, 7], &quot;A&quot;: [8, 9, 10, 11], &quot;C&quot;: [12, 13, 14, 15],},</span>
<span class="sd">    ...     index=list(&quot;badc&quot;),</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; matrix</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    a  1  5   9  13</span>
<span class="sd">    d  2  6  10  14</span>
<span class="sd">    c  3  7  11  15</span>

<span class="sd">    &gt;&gt;&gt; sort_by_citations(df, matrix, axis=&#39;columns&#39;, ascending=True, axis_name=&#39;c0&#39;)</span>
<span class="sd">        A  B   C  D</span>
<span class="sd">    b   8  4  12  0</span>
<span class="sd">    a   9  5  13  1</span>
<span class="sd">    d  10  6  14  2</span>
<span class="sd">    c  11  7  15  3</span>

<span class="sd">    &gt;&gt;&gt; sort_by_citations(df, matrix, axis=&#39;columns&#39;, ascending=False, axis_name=&#39;c0&#39;)</span>
<span class="sd">       D   C  B   A</span>
<span class="sd">    b  0  12  4   8</span>
<span class="sd">    a  1  13  5   9</span>
<span class="sd">    d  2  14  6  10</span>
<span class="sd">    c  3  15  7  11</span>

<span class="sd">    &gt;&gt;&gt; sort_by_citations(df, matrix, axis=&#39;index&#39;, ascending=True, axis_name=&#39;c1&#39;)</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    a  1  5   9  13</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    c  3  7  11  15</span>
<span class="sd">    d  2  6  10  14</span>

<span class="sd">    &gt;&gt;&gt; sort_by_citations(df, matrix, axis=&#39;index&#39;, ascending=False, axis_name=&#39;c1&#39;)</span>
<span class="sd">       D  B   A   C</span>
<span class="sd">    d  2  6  10  14</span>
<span class="sd">    c  3  7  11  15</span>
<span class="sd">    b  0  4   8  12</span>
<span class="sd">    a  1  5   9  13</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">terms</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">citations_by_term</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">axis_name</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">axis_sep</span><span class="p">)</span>
    <span class="n">terms_sorted</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">terms</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="n">axis_name</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">kind</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="n">ascending</span><span class="p">)</span>
        <span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;index&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">terms_sorted</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">matrix</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">terms_sorted</span><span class="p">]</span></div>


<div class="viewcode-block" id="DataFrame"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame">[docs]</a><span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Data structure derived from a `pandas:DataFrame </span>
<span class="sd">    &lt;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame&gt;`_. </span>
<span class="sd">    object with specialized functions to summarize and query bibliographic data.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">##  Compatitbility with pandas.DataFrame</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_constructor_expanddim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">##  Primitives</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.explode"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.explode">[docs]</a>    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transform each element of a field to a row, reseting index values.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame. Exploded dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...     &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 3;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...     &quot;ID&quot;: list(range(3)),</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors  ID</span>
<span class="sd">        0  author 0,author 1,author 2   0</span>
<span class="sd">        1                    author 3   1</span>
<span class="sd">        2                    author 4   2</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).explode(&#39;Authors&#39;)</span>
<span class="sd">            Authors  ID</span>
<span class="sd">        0  author 0   0</span>
<span class="sd">        1  author 1   0</span>
<span class="sd">        2  author 2   0</span>
<span class="sd">        3  author 3   1</span>
<span class="sd">        4  author 4   2</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">))))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
            <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
            <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">##  Data preparation functions</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.keywords_fusion"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.keywords_fusion">[docs]</a>    <span class="k">def</span> <span class="nf">keywords_fusion</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="o">=</span><span class="s2">&quot;Author Keywords&quot;</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">other</span><span class="o">=</span><span class="s2">&quot;Index Keywords&quot;</span><span class="p">,</span>
        <span class="n">sep_other</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">new_column</span><span class="o">=</span><span class="s2">&quot;Keywords&quot;</span><span class="p">,</span>
        <span class="n">sep_new_column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Combines keywords columns.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...      &quot;Author Keywords&quot;: &quot;k0;k2;,k1;,k3;,k4;,k5;&quot;.split(&quot;,&quot;),</span>
<span class="sd">        ...      &quot;Index Keywords&quot;: &quot;k0;k1;,k2;k3;,k3;,k4;,k6;&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Author Keywords Index Keywords</span>
<span class="sd">        0          k0;k2;         k0;k1;</span>
<span class="sd">        1             k1;         k2;k3;</span>
<span class="sd">        2             k3;            k3;</span>
<span class="sd">        3             k4;            k4;</span>
<span class="sd">        4             k5;            k6;</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).keywords_fusion()</span>
<span class="sd">          Author Keywords Index Keywords  Keywords</span>
<span class="sd">        0          k0;k2;         k0;k1;  k0;k1;k2</span>
<span class="sd">        1             k1;         k2;k3;  k1;k2;k3</span>
<span class="sd">        2             k3;            k3;        k3</span>
<span class="sd">        3             k4;            k4;        k4</span>
<span class="sd">        4             k5;            k6;     k5;k6</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sep_other</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep_other</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">other</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sep_new_column</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep_new_column</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span>

        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">author_keywords</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="n">index_keywords</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">other</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_other</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">author_keywords</span> <span class="o">+</span> <span class="n">index_keywords</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sep_new_column</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">keywords</span>
        <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="DataFrame.keywords_completation"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.keywords_completation">[docs]</a>    <span class="k">def</span> <span class="nf">keywords_completation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Complete keywords in &#39;Keywords&#39; column (if exists) from title and abstract.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;Keywords&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">keywords_fusion</span><span class="p">()</span>

        <span class="c1"># Remove copyright character from abstract</span>
        <span class="n">abstract</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Abstract</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u00a9</span><span class="s2">&quot;</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\u00a9</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>

        <span class="n">title_abstract</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Title</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">abstract</span>

        <span class="n">kyw</span> <span class="o">=</span> <span class="n">Keywords</span><span class="p">()</span>
        <span class="n">kyw</span><span class="o">.</span><span class="n">add_keywords</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">Keywords</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>

        <span class="n">keywords</span> <span class="o">=</span> <span class="n">title_abstract</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">kyw</span><span class="o">.</span><span class="n">extract_from_text</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">))</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Keywords</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;Keywords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">keywords</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.generate_ID"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.generate_ID">[docs]</a>    <span class="k">def</span> <span class="nf">generate_ID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates a sequence of integers as ID for each document.</span>


<span class="sd">        Args:</span>
<span class="sd">            fmt (str): Format used to generate ID column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">       </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...     &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 3;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors</span>
<span class="sd">        0  author 0,author 1,author 2</span>
<span class="sd">        1                    author 3</span>
<span class="sd">        2                    author 4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).generate_ID()</span>
<span class="sd">                              Authors  ID</span>
<span class="sd">        0  author 0,author 1,author 2   0</span>
<span class="sd">        1                    author 3   1</span>
<span class="sd">        2                    author 4   2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fmt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.disambiguate_authors"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.disambiguate_authors">[docs]</a>    <span class="k">def</span> <span class="nf">disambiguate_authors</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">col_Authors</span><span class="o">=</span><span class="s2">&quot;Authors&quot;</span><span class="p">,</span>
        <span class="n">sep_Authors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">col_AuthorsID</span><span class="o">=</span><span class="s2">&quot;Author(s) ID&quot;</span><span class="p">,</span>
        <span class="n">sep_AuthorsID</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Verify if author&#39;s names are unique. For duplicated names, based on `Author(s) ID` column, </span>
<span class="sd">        adds a consecutive number to the name.</span>


<span class="sd">        Args:</span>
<span class="sd">            col_Authors (str): Author&#39;s name column.</span>
<span class="sd">            sep_Authors (str): Character used as internal separator for the elements in the column with the author&#39;s name.</span>
<span class="sd">            col_AuthorsID (str): Author&#39;s ID column.</span>
<span class="sd">            sep_AuthorsID (str): Character used as internal separator for the elements in the column with the author&#39;s ID.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">       </span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...      &quot;Authors&quot;: &quot;author 0,author 0,author 0;author 0;author 0&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...      &quot;Author(s) ID&quot;: &quot;0;1;2;,3;,4;&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors Author(s) ID</span>
<span class="sd">        0  author 0,author 0,author 0       0;1;2;</span>
<span class="sd">        1                    author 0           3;</span>
<span class="sd">        2                    author 0           4;</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).disambiguate_authors()</span>
<span class="sd">                                    Authors Author(s) ID</span>
<span class="sd">        0  author 0,author 0(1),author 0(2)        0;1;2</span>
<span class="sd">        1                       author 0(3)            3</span>
<span class="sd">        2                       author 0(4)            4</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">sep_Authors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep_Authors</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">col_Authors</span><span class="p">]</span>

        <span class="bp">self</span><span class="p">[</span><span class="n">col_Authors</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col_Authors</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep_Authors</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">sep_AuthorsID</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">sep_AuthorsID</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">col_AuthorsID</span><span class="p">]</span>

        <span class="bp">self</span><span class="p">[</span><span class="n">col_AuthorsID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">col_AuthorsID</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">sep_AuthorsID</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[[</span><span class="n">col_Authors</span><span class="p">,</span> <span class="n">col_AuthorsID</span><span class="p">]]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;*info*&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col_Authors</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">col_AuthorsID</span><span class="p">])</span>
        <span class="p">]</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;*info*&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;*info*&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">v</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_Authors</span><span class="p">),</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_AuthorsID</span><span class="p">))</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;*info*&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;*info*&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">names_ids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>

            <span class="n">author_name</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;*info*&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">author_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="s2">&quot;*info*&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">author_name</span> <span class="ow">in</span> <span class="n">names_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">author_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">names_ids</span><span class="p">[</span><span class="n">author_name</span><span class="p">]:</span>
                    <span class="n">names_ids</span><span class="p">[</span><span class="n">author_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">names_ids</span><span class="p">[</span><span class="n">author_name</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">author_id</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">names_ids</span><span class="p">[</span><span class="n">author_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">author_id</span><span class="p">]</span>

        <span class="n">ids_names</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">author_name</span> <span class="ow">in</span> <span class="n">names_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">author_id</span> <span class="ow">in</span> <span class="n">names_ids</span><span class="p">[</span><span class="n">author_name</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">suffix</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">ids_names</span><span class="p">[</span><span class="n">author_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">author_name</span> <span class="o">+</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ids_names</span><span class="p">[</span><span class="n">author_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">author_name</span>
                <span class="n">suffix</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">result</span><span class="p">[</span><span class="n">col_Authors</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">col_AuthorsID</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">sep_Authors</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="n">ids_names</span><span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_AuthorsID</span><span class="p">)]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.remove_accents"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.remove_accents">[docs]</a>    <span class="k">def</span> <span class="nf">remove_accents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove accents for all strings on a DataFrame</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dataframe.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...      &quot;Authors&quot;: &quot;áàÁÀ;éèÉÈ;íìÌÍ;ÑÑÑñññ&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).remove_accents()</span>
<span class="sd">          Authors</span>
<span class="sd">        0    aaAA</span>
<span class="sd">        1    eeEE</span>
<span class="sd">        2    iiII</span>
<span class="sd">        3  NNNnnn</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">remove_accents</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="p">)</span></div>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">##  Row selection</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.get_rows_by_IDs"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.get_rows_by_IDs">[docs]</a>    <span class="k">def</span> <span class="nf">get_rows_by_IDs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IDs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extracts records using the ID number.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">IDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">IDs</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">IDs</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">## Basic data information</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.coverage"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.coverage">[docs]</a>    <span class="k">def</span> <span class="nf">coverage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Reports the number of not `None` elements for column in a dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Pandas DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>


<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...   {</span>
<span class="sd">        ...      &quot;Authors&quot;: &quot;author 0,author 0,author 0;author 0;author 0;author 1;author 2;author 0&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...      &quot;Author(s) ID&quot;: &quot;0;1;2;,3;,4;,5;,6;,7:&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...      &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...      &quot;Source title&quot;: [&#39;source {:d}&#39;.format(w) for w in range(5)] + [None],</span>
<span class="sd">        ...      &quot;None field&quot;: [None] * 6,</span>
<span class="sd">        ...   }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors Author(s) ID  ID Source title None field</span>
<span class="sd">        0  author 0,author 0,author 0       0;1;2;   0     source 0       None</span>
<span class="sd">        1                    author 0           3;   1     source 1       None</span>
<span class="sd">        2                    author 0           4;   2     source 2       None</span>
<span class="sd">        3                    author 1           5;   3     source 3       None</span>
<span class="sd">        4                    author 2           6;   4     source 4       None</span>
<span class="sd">        5                    author 0           7:   5         None       None</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).coverage()</span>
<span class="sd">                 Column  Number of items Coverage (%)</span>
<span class="sd">        0       Authors                6      100.00%</span>
<span class="sd">        1  Author(s) ID                6      100.00%</span>
<span class="sd">        2            ID                6      100.00%</span>
<span class="sd">        3  Source title                5       83.33%</span>
<span class="sd">        4    None field                0        0.00%</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Column&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;Number of items&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
                <span class="p">],</span>
                <span class="s2">&quot;Coverage (%)&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;</span><span class="si">{:5.2%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
                <span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.most_cited_documents"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.most_cited_documents">[docs]</a>    <span class="k">def</span> <span class="nf">most_cited_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the cited documents.</span>
<span class="sd">        </span>
<span class="sd">        Results:</span>
<span class="sd">            pandas.DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span>
            <span class="p">[</span><span class="s2">&quot;Title&quot;</span><span class="p">,</span> <span class="s2">&quot;Authors&quot;</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.most_cited_authors"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.most_cited_authors">[docs]</a>    <span class="k">def</span> <span class="nf">most_cited_authors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the cited authors.</span>
<span class="sd">        </span>
<span class="sd">        Results:</span>
<span class="sd">            pandas.DataFrame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term</span><span class="p">(</span><span class="s2">&quot;Authors&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">## Term extraction</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.extract_terms"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.extract_terms">[docs]</a>    <span class="k">def</span> <span class="nf">extract_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Extracts unique terms in a column, exploding multvalued columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; pdf = pd.DataFrame({&#39;A&#39;: [&#39;1;2&#39;, &#39;3&#39;, &#39;3;4;5&#39;], &#39;B&#39;:[0] * 3})</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(pdf).extract_terms(column=&#39;A&#39;, sep=&#39;;&#39;)</span>
<span class="sd">           A</span>
<span class="sd">        0  1</span>
<span class="sd">        1  2</span>
<span class="sd">        2  3</span>
<span class="sd">        3  4</span>
<span class="sd">        4  5</span>

<span class="sd">        &gt;&gt;&gt; pdf = pd.DataFrame({&#39;Authors&#39;: [&#39;xxx&#39;, &#39;xxx, zzz&#39;, &#39;yyy&#39;, &#39;xxx, yyy, zzz&#39;]})</span>
<span class="sd">        &gt;&gt;&gt; pdf</span>
<span class="sd">                 Authors</span>
<span class="sd">        0            xxx</span>
<span class="sd">        1       xxx, zzz</span>
<span class="sd">        2            yyy</span>
<span class="sd">        3  xxx, yyy, zzz</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(pdf).extract_terms(column=&#39;Authors&#39;)</span>
<span class="sd">          Authors</span>
<span class="sd">        0     xxx</span>
<span class="sd">        1     yyy</span>
<span class="sd">        2     zzz</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">())</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">column</span><span class="p">:</span> <span class="n">result</span><span class="p">})</span></div>

<div class="viewcode-block" id="DataFrame.count_terms"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.count_terms">[docs]</a>    <span class="k">def</span> <span class="nf">count_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Counts the number of different terms in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; pdf = pd.DataFrame({&#39;Authors&#39;: [&#39;xxx&#39;, &#39;xxx, zzz&#39;, &#39;yyy&#39;, &#39;xxx, yyy, zzz&#39;]})</span>
<span class="sd">        &gt;&gt;&gt; pdf</span>
<span class="sd">                 Authors</span>
<span class="sd">        0            xxx</span>
<span class="sd">        1       xxx, zzz</span>
<span class="sd">        2            yyy</span>
<span class="sd">        3  xxx, yyy, zzz</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(pdf).count_terms(column=&#39;Authors&#39;)</span>
<span class="sd">        3</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extract_terms</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">))</span></div>

<div class="viewcode-block" id="DataFrame.count_report"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.count_report">[docs]</a>    <span class="k">def</span> <span class="nf">count_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reports the number of different items per column in dataframe.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.        </span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &#39;Authors&#39;:  &#39;xxx,xxx; zzz,yyy; xxx; yyy; zzz&#39;.split(&#39;;&#39;),</span>
<span class="sd">        ...          &#39;Author(s) ID&#39;: &#39;0;1,    3;4;,  4;,  5;,  6;&#39;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &#39;Source title&#39;: &#39; s0,     s0,   s1,  s1, s2&#39;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &#39;Author Keywords&#39;: &#39;k0;k1, k0;k2, k3;k2;k1, k4, k5&#39;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &#39;Index Keywords&#39;: &#39;w0;w1, w0;w2, w3;k1;w1, w4, w5&#39;.split(&#39;,&#39;),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">            Authors Author(s) ID Source title Author Keywords Index Keywords</span>
<span class="sd">        0   xxx,xxx          0;1           s0           k0;k1          w0;w1</span>
<span class="sd">        1   zzz,yyy         3;4;           s0           k0;k2          w0;w2</span>
<span class="sd">        2       xxx           4;           s1        k3;k2;k1       w3;k1;w1</span>
<span class="sd">        3       yyy           5;           s1              k4             w4</span>
<span class="sd">        4       zzz           6;           s2              k5             w5</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).count_report()</span>
<span class="sd">                    Column  Number of items</span>
<span class="sd">        0          Authors                3</span>
<span class="sd">        1     Author(s) ID                7</span>
<span class="sd">        2     Source title                3</span>
<span class="sd">        3  Author Keywords                6</span>
<span class="sd">        4   Index Keywords                7</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Authors&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Author(s) ID&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Source title&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Author Keywords&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Index Keywords&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Column&quot;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span>
                <span class="s2">&quot;Number of items&quot;</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">count_terms</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span></div>

    <span class="c1">##</span>
    <span class="c1">##</span>
    <span class="c1">##  Analysis by term</span>
    <span class="c1">##</span>
    <span class="c1">##</span>

<div class="viewcode-block" id="DataFrame.summarize_by_term"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_by_term">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_by_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Summarize the number of documents and citations by term in a dataframe.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,14)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(4)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors  Cited by  ID</span>
<span class="sd">        0  author 0,author 1,author 2        10   0</span>
<span class="sd">        1                    author 0        11   1</span>
<span class="sd">        2                    author 1        12   2</span>
<span class="sd">        3                    author 3        13   3</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term(&#39;Authors&#39;, sep=&#39;,&#39;)</span>
<span class="sd">            Authors  Num Documents  Cited by      ID</span>
<span class="sd">        0  author 0              2        21  [0, 1]</span>
<span class="sd">        1  author 1              2        22  [0, 2]</span>
<span class="sd">        2  author 2              1        10     [0]</span>
<span class="sd">        3  author 3              1        13     [3]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term(&#39;Authors&#39;, sep=&#39;,&#39;, keywords=keywords)</span>
<span class="sd">            Authors  Num Documents  Cited by      ID</span>
<span class="sd">        0  author 1              2        22  [0, 2]</span>
<span class="sd">        1  author 2              1        10     [0]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">[[</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">ID</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">column</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.documents_by_term"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.documents_by_term">[docs]</a>    <span class="k">def</span> <span class="nf">documents_by_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents per term in a given column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,14)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(4)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors  Cited by  ID</span>
<span class="sd">        0  author 0,author 1,author 2        10   0</span>
<span class="sd">        1                    author 0        11   1</span>
<span class="sd">        2                    author 1        12   2</span>
<span class="sd">        3                    author 3        13   3</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term(&#39;Authors&#39;)</span>
<span class="sd">            Authors  Num Documents      ID</span>
<span class="sd">        0  author 0              2  [0, 1]</span>
<span class="sd">        1  author 1              2  [0, 2]</span>
<span class="sd">        2  author 2              1     [0]</span>
<span class="sd">        3  author 3              1     [3]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term(&#39;Authors&#39;, sep=&#39;,&#39;, keywords=keywords)</span>
<span class="sd">            Authors  Num Documents      ID</span>
<span class="sd">        0  author 1              2  [0, 2]</span>
<span class="sd">        1  author 2              1     [0]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.citations_by_term"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.citations_by_term">[docs]</a>    <span class="k">def</span> <span class="nf">citations_by_term</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of citations by item in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,14)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(4)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">                              Authors  Cited by  ID</span>
<span class="sd">        0  author 0,author 1,author 2        10   0</span>
<span class="sd">        1                    author 0        11   1</span>
<span class="sd">        2                    author 1        12   2</span>
<span class="sd">        3                    author 3        13   3</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term(&#39;Authors&#39;)</span>
<span class="sd">            Authors  Cited by      ID</span>
<span class="sd">        0  author 1        22  [0, 2]</span>
<span class="sd">        1  author 0        21  [0, 1]</span>
<span class="sd">        2  author 3        13     [3]</span>
<span class="sd">        3  author 2        10     [0]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">            Authors  Cited by      ID</span>
<span class="sd">        0  author 1        22  [0, 2]</span>
<span class="sd">        1  author 2        10     [0]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1"># Documents and citations by year</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.summarize_by_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_by_year">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_by_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of document and the number of total citations per year.</span>
<span class="sd">        This funciton adds the missing years in the sequence.</span>

<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            cumulative (bool): cumulate values per year.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2016],</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year  Cited by  ID</span>
<span class="sd">        0  2010        10   0</span>
<span class="sd">        1  2010        11   1</span>
<span class="sd">        2  2011        12   2</span>
<span class="sd">        3  2011        13   3</span>
<span class="sd">        4  2012        14   4</span>
<span class="sd">        5  2016        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_year()</span>
<span class="sd">           Year  Cited by  Num Documents      ID</span>
<span class="sd">        0  2010        21              2  [0, 1]</span>
<span class="sd">        1  2011        25              2  [2, 3]</span>
<span class="sd">        2  2012        14              1     [4]</span>
<span class="sd">        3  2013         0              0      []</span>
<span class="sd">        4  2014         0              0      []</span>
<span class="sd">        5  2015         0              0      []</span>
<span class="sd">        6  2016        15              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_year(cumulative=True)</span>
<span class="sd">           Year  Cited by  Num Documents      ID</span>
<span class="sd">        0  2010        21              2  [0, 1]</span>
<span class="sd">        1  2011        46              4  [2, 3]</span>
<span class="sd">        2  2012        60              5     [4]</span>
<span class="sd">        3  2013        60              5      []</span>
<span class="sd">        4  2014        60              5      []</span>
<span class="sd">        5  2015        60              5      []</span>
<span class="sd">        6  2016        75              6     [5]</span>


<span class="sd">        Comparison with `summarize_by_term`.</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term(&#39;Year&#39;)</span>
<span class="sd">           Year  Num Documents  Cited by      ID</span>
<span class="sd">        0  2010              2        21  [0, 1]</span>
<span class="sd">        1  2011              2        25  [2, 3]</span>
<span class="sd">        2  2012              1        14     [4]</span>
<span class="sd">        3  2016              1        15     [5]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">[[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">ID</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">cumulative</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.documents_by_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.documents_by_year">[docs]</a>    <span class="k">def</span> <span class="nf">documents_by_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents per year. This function adds the missing years in the sequence.</span>

<span class="sd">        Args:</span>
<span class="sd">            cumulative (bool): cumulate values per year.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year  Cited by  ID</span>
<span class="sd">        0  2010        10   0</span>
<span class="sd">        1  2010        11   1</span>
<span class="sd">        2  2011        12   2</span>
<span class="sd">        3  2011        13   3</span>
<span class="sd">        4  2012        14   4</span>
<span class="sd">        5  2014        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_year()</span>
<span class="sd">           Year  Num Documents      ID</span>
<span class="sd">        0  2010              2  [0, 1]</span>
<span class="sd">        1  2011              2  [2, 3]</span>
<span class="sd">        2  2012              1     [4]</span>
<span class="sd">        3  2013              0      []</span>
<span class="sd">        4  2014              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_year(cumulative=True)</span>
<span class="sd">           Year  Num Documents      ID</span>
<span class="sd">        0  2010              2  [0, 1]</span>
<span class="sd">        1  2011              4  [2, 3]</span>
<span class="sd">        2  2012              5     [4]</span>
<span class="sd">        3  2013              5      []</span>
<span class="sd">        4  2014              6     [5]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_year</span><span class="p">(</span><span class="n">cumulative</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.citations_by_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.citations_by_year">[docs]</a>    <span class="k">def</span> <span class="nf">citations_by_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of citations by year. </span>
<span class="sd">        This function adds the missing years in the sequence.</span>

<span class="sd">        Args:</span>
<span class="sd">            cumulative (bool): cumulate values per year.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year  Cited by  ID</span>
<span class="sd">        0  2010        10   0</span>
<span class="sd">        1  2010        11   1</span>
<span class="sd">        2  2011        12   2</span>
<span class="sd">        3  2011        13   3</span>
<span class="sd">        4  2012        14   4</span>
<span class="sd">        5  2014        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_year()</span>
<span class="sd">           Year  Cited by      ID</span>
<span class="sd">        0  2010        21  [0, 1]</span>
<span class="sd">        1  2011        25  [2, 3]</span>
<span class="sd">        2  2012        14     [4]</span>
<span class="sd">        3  2013         0      []</span>
<span class="sd">        4  2014        15     [5]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_year(cumulative=True)</span>
<span class="sd">           Year  Cited by      ID</span>
<span class="sd">        0  2010        21  [0, 1]</span>
<span class="sd">        1  2011        46  [2, 3]</span>
<span class="sd">        2  2012        60     [4]</span>
<span class="sd">        3  2013        60      []</span>
<span class="sd">        4  2014        75     [5]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_year</span><span class="p">(</span><span class="n">cumulative</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#  Documents and citations by term per year</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.summarize_by_term_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_by_term_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_by_term_per_year</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents and citations by term per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2        10   0</span>
<span class="sd">        1  2010                    author 0        11   1</span>
<span class="sd">        2  2011                    author 1        12   2</span>
<span class="sd">        3  2011                    author 3        13   3</span>
<span class="sd">        4  2012                    author 4        14   4</span>
<span class="sd">        5  2014                    author 4        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term_per_year(&#39;Authors&#39;)</span>
<span class="sd">            Authors  Year  Cited by  Num Documents      ID</span>
<span class="sd">        0  author 0  2010        21              2  [0, 1]</span>
<span class="sd">        1  author 1  2010        10              1     [0]</span>
<span class="sd">        2  author 2  2010        10              1     [0]</span>
<span class="sd">        3  author 1  2011        12              1     [2]</span>
<span class="sd">        4  author 3  2011        13              1     [3]</span>
<span class="sd">        5  author 4  2012        14              1     [4]</span>
<span class="sd">        6  author 4  2014        15              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term_per_year(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">            Authors  Year  Cited by  Num Documents   ID</span>
<span class="sd">        0  author 1  2010        10              1  [0]</span>
<span class="sd">        1  author 2  2010        10              1  [0]</span>
<span class="sd">        2  author 1  2011        12              1  [2]</span>
<span class="sd">        3  author 3  2011        13              1  [3]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">[[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]])</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">ID</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.documents_by_term_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.documents_by_term_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">documents_by_term_per_year</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents by term per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>


<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2        10   0</span>
<span class="sd">        1  2010                    author 0        11   1</span>
<span class="sd">        2  2011                    author 1        12   2</span>
<span class="sd">        3  2011                    author 3        13   3</span>
<span class="sd">        4  2012                    author 4        14   4</span>
<span class="sd">        5  2014                    author 4        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;)</span>
<span class="sd">            Authors  Year  Num Documents      ID</span>
<span class="sd">        0  author 0  2010              2  [0, 1]</span>
<span class="sd">        1  author 1  2010              1     [0]</span>
<span class="sd">        2  author 2  2010              1     [0]</span>
<span class="sd">        3  author 1  2011              1     [2]</span>
<span class="sd">        4  author 3  2011              1     [3]</span>
<span class="sd">        5  author 4  2012              1     [4]</span>
<span class="sd">        6  author 4  2014              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">              author 0  author 1  author 2  author 3  author 4</span>
<span class="sd">        2010         2         1         1         0         0</span>
<span class="sd">        2011         0         1         0         1         0</span>
<span class="sd">        2012         0         0         0         0         1</span>
<span class="sd">        2014         0         0         0         0         1</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, as_matrix=True, minmax=(2, None))</span>
<span class="sd">              author 0</span>
<span class="sd">        2010         2</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, as_matrix=True, minmax=(0, 1))</span>
<span class="sd">              author 1  author 2  author 3  author 4</span>
<span class="sd">        2010         1         1         0         0</span>
<span class="sd">        2011         1         0         1         0</span>
<span class="sd">        2012         0         0         0         1</span>
<span class="sd">        2014         0         0         0         1</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, keywords=keywords, as_matrix=True)</span>
<span class="sd">              author 1  author 2  author 3</span>
<span class="sd">        2010         1         1         0</span>
<span class="sd">        2011         1         0         1</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term_per_year</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
            <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_value</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.gant"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.gant">[docs]</a>    <span class="k">def</span> <span class="nf">gant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents by term per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>


<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2011, 2011, 2012, 2015, 2012, 2016],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,17)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(7)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">              author 0  author 1  author 2  author 3  author 4</span>
<span class="sd">        2010         1         1         1         0         0</span>
<span class="sd">        2011         1         1         0         0         0</span>
<span class="sd">        2012         0         0         0         1         1</span>
<span class="sd">        2015         0         0         0         1         0</span>
<span class="sd">        2016         0         0         0         0         1</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).gant(&#39;Authors&#39;)</span>
<span class="sd">              author 0  author 1  author 2  author 3  author 4</span>
<span class="sd">        2010         1         1         1         0         0</span>
<span class="sd">        2011         1         1         0         0         0</span>
<span class="sd">        2012         0         0         0         1         1</span>
<span class="sd">        2013         0         0         0         1         1</span>
<span class="sd">        2014         0         0         0         1         1</span>
<span class="sd">        2015         0         0         0         1         1</span>
<span class="sd">        2016         0         0         0         0         1</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).gant(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">              author 1  author 2  author 3</span>
<span class="sd">        2010         1         1         0</span>
<span class="sd">        2011         1         0         0</span>
<span class="sd">        2012         0         0         1</span>
<span class="sd">        2013         0         0         1</span>
<span class="sd">        2014         0         0         1</span>
<span class="sd">        2015         0         0         1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term_per_year</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span>
        <span class="p">)</span>
        <span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="n">year</span> <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">matrix1</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">matrix1</span> <span class="o">=</span> <span class="n">matrix1</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">matrix1</span> <span class="o">=</span> <span class="n">matrix1</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>

        <span class="n">matrix2</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">matrix2</span> <span class="o">=</span> <span class="n">matrix2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">matrix2</span> <span class="o">=</span> <span class="n">matrix2</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
        <span class="n">matrix2</span> <span class="o">=</span> <span class="n">matrix2</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
        <span class="n">matrix2</span> <span class="o">=</span> <span class="n">matrix2</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">matrix1</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">matrix2</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">True</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.citations_by_term_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.citations_by_term_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">citations_by_term_per_year</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of citations by term by year in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>


<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2        10   0</span>
<span class="sd">        1  2010                    author 0        11   1</span>
<span class="sd">        2  2011                    author 1        12   2</span>
<span class="sd">        3  2011                    author 3        13   3</span>
<span class="sd">        4  2012                    author 4        14   4</span>
<span class="sd">        5  2014                    author 4        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term_per_year(&#39;Authors&#39;)</span>
<span class="sd">            Authors  Year  Cited by      ID</span>
<span class="sd">        0  author 0  2010        21  [0, 1]</span>
<span class="sd">        1  author 2  2010        10     [0]</span>
<span class="sd">        2  author 1  2010        10     [0]</span>
<span class="sd">        3  author 3  2011        13     [3]</span>
<span class="sd">        4  author 1  2011        12     [2]</span>
<span class="sd">        5  author 4  2012        14     [4]</span>
<span class="sd">        6  author 4  2014        15     [5]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term_per_year(&#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">              author 0  author 1  author 2  author 3  author 4</span>
<span class="sd">        2010        21        10        10         0         0</span>
<span class="sd">        2011         0        12         0        13         0</span>
<span class="sd">        2012         0         0         0         0        14</span>
<span class="sd">        2014         0         0         0         0        15</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term_per_year(&#39;Authors&#39;, as_matrix=True, minmax=(12, 15))</span>
<span class="sd">              author 1  author 3  author 4</span>
<span class="sd">        2011        12        13         0</span>
<span class="sd">        2012         0         0        14</span>
<span class="sd">        2014         0         0        15</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_term_per_year(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">            Authors  Year  Cited by   ID</span>
<span class="sd">        0  author 2  2010        10  [0]</span>
<span class="sd">        1  author 1  2010        10  [0]</span>
<span class="sd">        2  author 3  2011        13  [3]</span>
<span class="sd">        3  author 1  2011        12  [2]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term_per_year</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
            <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_value</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#  Documents and citations by term per term per year</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.summarize_by_term_per_term_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_by_term_per_term_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_by_term_per_term_per_year</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents and citations by term per term by year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Author Keywords&quot;: &quot;w0;w1,w0,w1,w5;w3;w4,w5,w3&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2           w0;w1        10   0</span>
<span class="sd">        1  2010                    author 0              w0        11   1</span>
<span class="sd">        2  2011                    author 1              w1        12   2</span>
<span class="sd">        3  2011                    author 3        w5;w3;w4        13   3</span>
<span class="sd">        4  2012                    author 4              w5        14   4</span>
<span class="sd">        5  2014                    author 4              w3        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term_per_term_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">             Authors Author Keywords  Year  Cited by  Num Documents      ID</span>
<span class="sd">        0   author 0              w0  2010        21              2  [0, 1]</span>
<span class="sd">        1   author 0              w1  2010        10              1     [0]</span>
<span class="sd">        2   author 1              w0  2010        10              1     [0]</span>
<span class="sd">        3   author 1              w1  2010        10              1     [0]</span>
<span class="sd">        4   author 2              w0  2010        10              1     [0]</span>
<span class="sd">        5   author 2              w1  2010        10              1     [0]</span>
<span class="sd">        6   author 1              w1  2011        12              1     [2]</span>
<span class="sd">        7   author 3              w3  2011        13              1     [3]</span>
<span class="sd">        8   author 3              w4  2011        13              1     [3]</span>
<span class="sd">        9   author 3              w5  2011        13              1     [3]</span>
<span class="sd">        10  author 4              w5  2012        14              1     [4]</span>
<span class="sd">        11  author 4              w3  2014        15              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;, &#39;w1&#39;, &#39;w3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_by_term_per_term_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">            Authors Author Keywords  Year  Cited by  Num Documents   ID</span>
<span class="sd">        0  author 1              w1  2010        10              1  [0]</span>
<span class="sd">        1  author 2              w1  2010        10              1  [0]</span>
<span class="sd">        2  author 1              w1  2011        12              1  [2]</span>
<span class="sd">        3  author 3              w3  2011        13              1  [3]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">[[</span><span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_IDX</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_COL</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
            <span class="n">ID</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="s2">&quot;Year&quot;</span><span class="p">])</span>
            <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">})</span>
            <span class="o">.</span><span class="n">reset_index</span><span class="p">()[</span><span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_IDX</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_COL</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.documents_by_terms_per_terms_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.documents_by_terms_per_terms_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">documents_by_terms_per_terms_per_year</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of documents by term per term per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Author Keywords&quot;: &quot;w0;w1,w0,w1,w5;w3;w4,w5,w3&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2           w0;w1        10   0</span>
<span class="sd">        1  2010                    author 0              w0        11   1</span>
<span class="sd">        2  2011                    author 1              w1        12   2</span>
<span class="sd">        3  2011                    author 3        w5;w3;w4        13   3</span>
<span class="sd">        4  2012                    author 4              w5        14   4</span>
<span class="sd">        5  2014                    author 4              w3        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_terms_per_terms_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">             Authors Author Keywords  Year  Num Documents      ID</span>
<span class="sd">        0   author 0              w0  2010              2  [0, 1]</span>
<span class="sd">        1   author 0              w1  2010              1     [0]</span>
<span class="sd">        2   author 1              w0  2010              1     [0]</span>
<span class="sd">        3   author 1              w1  2010              1     [0]</span>
<span class="sd">        4   author 2              w0  2010              1     [0]</span>
<span class="sd">        5   author 2              w1  2010              1     [0]</span>
<span class="sd">        6   author 1              w1  2011              1     [2]</span>
<span class="sd">        7   author 3              w3  2011              1     [3]</span>
<span class="sd">        8   author 3              w4  2011              1     [3]</span>
<span class="sd">        9   author 3              w5  2011              1     [3]</span>
<span class="sd">        10  author 4              w5  2012              1     [4]</span>
<span class="sd">        11  author 4              w3  2014              1     [5]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;, &#39;w1&#39;, &#39;w3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_terms_per_terms_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">            Authors Author Keywords  Year  Num Documents   ID</span>
<span class="sd">        0  author 1              w1  2010              1  [0]</span>
<span class="sd">        1  author 2              w1  2010              1  [0]</span>
<span class="sd">        2  author 1              w1  2011              1  [2]</span>
<span class="sd">        3  author 3              w3  2011              1  [3]</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term_per_term_per_year</span><span class="p">(</span>
            <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="p">,</span> <span class="n">sep_COL</span><span class="p">,</span> <span class="n">keywords</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.citations_by_terms_per_terms_per_year"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.citations_by_terms_per_terms_per_year">[docs]</a>    <span class="k">def</span> <span class="nf">citations_by_terms_per_terms_per_year</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of citations by term per term per year.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Author Keywords&quot;: &quot;w0;w1,w0,w1,w5;w3;w4,w5,w3&quot;.split(&#39;,&#39;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,16)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(6)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2           w0;w1        10   0</span>
<span class="sd">        1  2010                    author 0              w0        11   1</span>
<span class="sd">        2  2011                    author 1              w1        12   2</span>
<span class="sd">        3  2011                    author 3        w5;w3;w4        13   3</span>
<span class="sd">        4  2012                    author 4              w5        14   4</span>
<span class="sd">        5  2014                    author 4              w3        15   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_terms_per_terms_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">             Authors Author Keywords  Year  Cited by      ID</span>
<span class="sd">        0   author 0              w0  2010        21  [0, 1]</span>
<span class="sd">        1   author 0              w1  2010        10     [0]</span>
<span class="sd">        2   author 1              w0  2010        10     [0]</span>
<span class="sd">        3   author 1              w1  2010        10     [0]</span>
<span class="sd">        4   author 2              w0  2010        10     [0]</span>
<span class="sd">        5   author 2              w1  2010        10     [0]</span>
<span class="sd">        6   author 1              w1  2011        12     [2]</span>
<span class="sd">        7   author 3              w3  2011        13     [3]</span>
<span class="sd">        8   author 3              w4  2011        13     [3]</span>
<span class="sd">        9   author 3              w5  2011        13     [3]</span>
<span class="sd">        10  author 4              w5  2012        14     [4]</span>
<span class="sd">        11  author 4              w3  2014        15     [5]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 1&#39;, &#39;author 2&#39;, &#39;author 3&#39;, &#39;w1&#39;, &#39;w3&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).citations_by_terms_per_terms_per_year(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">            Authors Author Keywords  Year  Cited by   ID</span>
<span class="sd">        0  author 1              w1  2010        10  [0]</span>
<span class="sd">        1  author 2              w1  2010        10  [0]</span>
<span class="sd">        2  author 1              w1  2011        12  [2]</span>
<span class="sd">        3  author 3              w3  2011        13  [3]</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_by_term_per_term_per_year</span><span class="p">(</span>
            <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="p">,</span> <span class="n">sep_COL</span><span class="p">,</span> <span class="n">keywords</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#  Co-occurrence</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.summarize_co_occurrence"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_co_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_co_occurrence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Summarize occurrence and citations by terms in two different columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_co_occurrence(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;)</span>
<span class="sd">          Authors (IDX) Author Keywords (COL)  Num Documents  Cited by      ID</span>
<span class="sd">        0             A                     a              2         1  [0, 1]</span>
<span class="sd">        1             A                     b              1         1     [1]</span>
<span class="sd">        2             A                     c              1         3     [3]</span>
<span class="sd">        3             B                     a              1         1     [1]</span>
<span class="sd">        4             B                     b              2         3  [1, 2]</span>
<span class="sd">        5             B                     c              2         7  [3, 4]</span>
<span class="sd">        6             B                     d              1         4     [4]</span>
<span class="sd">        7             C                     c              1         3     [3]</span>
<span class="sd">        8             D                     c              1         4     [4]</span>
<span class="sd">        9             D                     d              1         4     [4]</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;B&#39;, &#39;C&#39;, &#39;a&#39;, &#39;b&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_co_occurrence(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">          Authors (IDX) Author Keywords (COL)  Num Documents  Cited by      ID</span>
<span class="sd">        0             B                     a              1         1     [1]</span>
<span class="sd">        1             B                     b              2         3  [1, 2]</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_pairs</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sep_IDX</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_IDX</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">sep_COL</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep_COL</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="n">idx0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="n">idx1</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="n">sep_IDX</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column_IDX</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="p">:</span>
            <span class="n">sep_IDX</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column_IDX</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sep_COL</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column_COL</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="p">:</span>
            <span class="n">sep_COL</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column_COL</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">generate_pairs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">column_IDX</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="n">column_COL</span><span class="p">])</span>
        <span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;pairs&quot;</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">}</span>
        <span class="p">)</span>

        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">result</span><span class="p">[</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[</span><span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span>
            <span class="p">[</span>
                <span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span>
                <span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ID&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.co_occurrence"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.co_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">co_occurrence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column_IDX</span><span class="p">,</span>
        <span class="n">column_COL</span><span class="p">,</span>
        <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">as_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the co-occurrence of two terms in different colums. The report adds</span>
<span class="sd">        the number of documents by term between brackets.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_occurrence(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;)</span>
<span class="sd">          Authors (IDX) Author Keywords (COL)  Num Documents      ID</span>
<span class="sd">        0             A                     a              2  [0, 1]</span>
<span class="sd">        1             B                     b              2  [1, 2]</span>
<span class="sd">        2             B                     c              2  [3, 4]</span>
<span class="sd">        3             A                     b              1     [1]</span>
<span class="sd">        4             A                     c              1     [3]</span>
<span class="sd">        5             B                     a              1     [1]</span>
<span class="sd">        6             B                     d              1     [4]</span>
<span class="sd">        7             C                     c              1     [3]</span>
<span class="sd">        8             D                     c              1     [4]</span>
<span class="sd">        9             D                     d              1     [4]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_occurrence(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;, as_matrix=True)</span>
<span class="sd">           a  b  c  d</span>
<span class="sd">        A  2  1  1  0</span>
<span class="sd">        B  1  2  2  1</span>
<span class="sd">        C  0  0  1  0</span>
<span class="sd">        D  0  0  1  1</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_occurrence(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;, as_matrix=True, minmax=(2,2))</span>
<span class="sd">           a  b  c</span>
<span class="sd">        A  2  0  0</span>
<span class="sd">        B  0  2  2</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;c&#39;, &#39;d&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_occurrence(&#39;Authors&#39;, &#39;Author Keywords&#39;, as_matrix=True, keywords=keywords)</span>
<span class="sd">           c  d</span>
<span class="sd">        A  1  0</span>
<span class="sd">        B  2  1</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_dic</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">):</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">term</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:s}</span><span class="s2"> [</span><span class="si">{:d}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">new_names</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">new_names</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">new_names</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_co_occurrence</span><span class="p">(</span>
            <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="p">,</span> <span class="n">sep_COL</span><span class="p">,</span> <span class="n">keywords</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
            <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_value</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">,],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span>
                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.co_citation"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.co_citation">[docs]</a>    <span class="k">def</span> <span class="nf">co_citation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column_IDX</span><span class="p">,</span>
        <span class="n">column_COL</span><span class="p">,</span>
        <span class="n">sep_IDX</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep_COL</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">as_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the number of citations shared by two terms in different columns.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the column to explode. Their terms are used in the index of the result dataframe.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the column to explode. Their terms are used in the columns of the result dataframe.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_citation(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;)</span>
<span class="sd">          Authors (IDX) Author Keywords (COL)  Cited by      ID</span>
<span class="sd">        0             B                     c         7  [3, 4]</span>
<span class="sd">        1             B                     d         4     [4]</span>
<span class="sd">        2             D                     c         4     [4]</span>
<span class="sd">        3             D                     d         4     [4]</span>
<span class="sd">        4             A                     c         3     [3]</span>
<span class="sd">        5             B                     b         3  [1, 2]</span>
<span class="sd">        6             C                     c         3     [3]</span>
<span class="sd">        7             A                     a         1  [0, 1]</span>
<span class="sd">        8             A                     b         1     [1]</span>
<span class="sd">        9             B                     a         1     [1]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_citation(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;, as_matrix=True)</span>
<span class="sd">           a  b  c  d</span>
<span class="sd">        A  1  1  3  0</span>
<span class="sd">        B  1  3  7  4</span>
<span class="sd">        C  0  0  3  0</span>
<span class="sd">        D  0  0  4  4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_citation(column_IDX=&#39;Authors&#39;, column_COL=&#39;Author Keywords&#39;, as_matrix=True, minmax=(3,4))</span>
<span class="sd">           b  c  d</span>
<span class="sd">        A  0  3  0</span>
<span class="sd">        B  3  0  4</span>
<span class="sd">        C  0  3  0</span>
<span class="sd">        D  0  4  4</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;c&#39;, &#39;d&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_citation(&#39;Authors&#39;, &#39;Author Keywords&#39;, as_matrix=True, keywords=keywords)        </span>
<span class="sd">           c  d</span>
<span class="sd">        A  3  0</span>
<span class="sd">        B  7  4</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_dic</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">):</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">citations_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">term</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:s}</span><span class="s2"> [</span><span class="si">{:d}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">new_names</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">new_names</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">new_names</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_co_occurrence</span><span class="p">(</span>
            <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">,</span> <span class="n">sep_IDX</span><span class="p">,</span> <span class="n">sep_COL</span><span class="p">,</span> <span class="n">keywords</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
            <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_value</span><span class="p">]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Cited by&quot;</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">column_IDX</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">column_COL</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span>
                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#  Occurrence</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.summarize_occurrence"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.summarize_occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Summarize occurrence and citations by terms in a column of a dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;D&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors  Cited by  ID</span>
<span class="sd">        0       A         0   0</span>
<span class="sd">        1       A         1   1</span>
<span class="sd">        2     A,B         2   2</span>
<span class="sd">        3       B         3   3</span>
<span class="sd">        4   A,B,C         4   4</span>
<span class="sd">        5       D         5   5</span>
<span class="sd">        6     B,D         6   6</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_occurrence(column=&#39;Authors&#39;)</span>
<span class="sd">           Authors (IDX) Authors (COL)  Num Documents  Cited by            ID</span>
<span class="sd">        0              A             A              4         7  [0, 1, 2, 4]</span>
<span class="sd">        1              A             B              2         6        [2, 4]</span>
<span class="sd">        2              A             C              1         4           [4]</span>
<span class="sd">        3              B             A              2         6        [2, 4]</span>
<span class="sd">        4              B             B              4        15  [2, 3, 4, 6]</span>
<span class="sd">        5              B             C              1         4           [4]</span>
<span class="sd">        6              B             D              1         6           [6]</span>
<span class="sd">        7              C             A              1         4           [4]</span>
<span class="sd">        8              C             B              1         4           [4]</span>
<span class="sd">        9              C             C              1         4           [4]</span>
<span class="sd">        10             D             B              1         6           [6]</span>
<span class="sd">        11             D             D              2        11        [5, 6]</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).summarize_occurrence(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">          Authors (IDX) Authors (COL)  Num Documents  Cited by            ID</span>
<span class="sd">        0             A             A              4         7  [0, 1, 2, 4]</span>
<span class="sd">        1             A             B              2         6        [2, 4]</span>
<span class="sd">        2             B             A              2         6        [2, 4]</span>
<span class="sd">        3             B             B              4        15  [2, 3, 4, 6]</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_pairs</span><span class="p">(</span><span class="n">w</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">idx0</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
                <span class="c1"># for idx1 in range(idx0, len(w)):</span>
                <span class="k">for</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">w</span><span class="p">[</span><span class="n">idx0</span><span class="p">],</span> <span class="n">w</span><span class="p">[</span><span class="n">idx1</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="p">:</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">generate_pairs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;pairs&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;Cited by&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">})</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">})</span>
        <span class="p">)</span>

        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;Cited by&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">result</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;pairs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pairs&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span>
            <span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span> <span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="s2">&quot;Cited by&quot;</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.occurrence"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.occurrence">[docs]</a>    <span class="k">def</span> <span class="nf">occurrence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the occurrence between the terms in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;D&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors  Cited by  ID</span>
<span class="sd">        0       A         0   0</span>
<span class="sd">        1       A         1   1</span>
<span class="sd">        2     A,B         2   2</span>
<span class="sd">        3       B         3   3</span>
<span class="sd">        4   A,B,C         4   4</span>
<span class="sd">        5       D         5   5</span>
<span class="sd">        6     B,D         6   6</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence(column=&#39;Authors&#39;)</span>
<span class="sd">           Authors (IDX) Authors (COL)  Num Documents            ID</span>
<span class="sd">        0              A             A              4  [0, 1, 2, 4]</span>
<span class="sd">        1              B             B              4  [2, 3, 4, 6]</span>
<span class="sd">        2              A             B              2        [2, 4]</span>
<span class="sd">        3              B             A              2        [2, 4]</span>
<span class="sd">        4              D             D              2        [5, 6]</span>
<span class="sd">        5              A             C              1           [4]</span>
<span class="sd">        6              B             C              1           [4]</span>
<span class="sd">        7              B             D              1           [6]</span>
<span class="sd">        8              C             A              1           [4]</span>
<span class="sd">        9              C             B              1           [4]</span>
<span class="sd">        10             C             C              1           [4]</span>
<span class="sd">        11             D             B              1           [6]</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence(column=&#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        A  4  2  1  0</span>
<span class="sd">        B  2  4  1  1</span>
<span class="sd">        C  1  1  1  0</span>
<span class="sd">        D  0  1  0  2</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence(column=&#39;Authors&#39;, as_matrix=True, minmax=(2,3))</span>
<span class="sd">           A  B  D</span>
<span class="sd">        A  0  2  0</span>
<span class="sd">        B  2  0  0</span>
<span class="sd">        D  0  0  2</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence(&#39;Authors&#39;, as_matrix=True, keywords=keywords)</span>
<span class="sd">           A  B</span>
<span class="sd">        A  4  2</span>
<span class="sd">        B  2  4</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_dic</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">):</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
            <span class="n">new_names</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">term</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">{:s}</span><span class="s2"> [</span><span class="si">{:d}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">term</span><span class="p">,</span> <span class="n">docs_per_term</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">new_names</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">new_names</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">],</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">new_names</span>

        <span class="n">column_IDX</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span>
        <span class="n">column_COL</span> <span class="o">=</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize_occurrence</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Cited by&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
            <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_value</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_value</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_IDX</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column_COL</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
            <span class="p">[</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span> <span class="n">column_IDX</span><span class="p">,</span> <span class="n">column_COL</span><span class="p">],</span>
            <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span>
            <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">column_IDX</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="n">column_COL</span><span class="p">,</span>
                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.occurrence_map"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.occurrence_map">[docs]</a>    <span class="k">def</span> <span class="nf">occurrence_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes a occurrence between terms in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dictionary</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;D&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors  ID</span>
<span class="sd">        0       A   0</span>
<span class="sd">        1       A   1</span>
<span class="sd">        2     A,B   2</span>
<span class="sd">        3       B   3</span>
<span class="sd">        4   A,B,C   4</span>
<span class="sd">        5       D   5</span>
<span class="sd">        6     B,D   6</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence_map(column=&#39;Authors&#39;)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;], &#39;docs&#39;: [&#39;doc#0&#39;, &#39;doc#1&#39;, &#39;doc#2&#39;, &#39;doc#3&#39;, &#39;doc#4&#39;, &#39;doc#5&#39;], &#39;edges&#39;: [(&#39;A&#39;, &#39;doc#0&#39;), (&#39;A&#39;, &#39;doc#1&#39;), (&#39;B&#39;, &#39;doc#1&#39;), (&#39;A&#39;, &#39;doc#2&#39;), (&#39;B&#39;, &#39;doc#2&#39;), (&#39;C&#39;, &#39;doc#2&#39;), (&#39;B&#39;, &#39;doc#3&#39;), (&#39;B&#39;, &#39;doc#4&#39;), (&#39;D&#39;, &#39;doc#4&#39;), (&#39;D&#39;, &#39;doc#5&#39;)], &#39;label_terms&#39;: {&#39;A&#39;: &#39;A&#39;, &#39;B&#39;: &#39;B&#39;, &#39;C&#39;: &#39;C&#39;, &#39;D&#39;: &#39;D&#39;}, &#39;label_docs&#39;: {&#39;doc#0&#39;: 2, &#39;doc#1&#39;: 1, &#39;doc#2&#39;: 1, &#39;doc#3&#39;: 1, &#39;doc#4&#39;: 1, &#39;doc#5&#39;: 1}}</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).occurrence_map(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;], &#39;docs&#39;: [&#39;doc#0&#39;, &#39;doc#1&#39;, &#39;doc#2&#39;, &#39;doc#3&#39;, &#39;doc#4&#39;], &#39;edges&#39;: [(&#39;A&#39;, &#39;doc#0&#39;), (&#39;A&#39;, &#39;doc#1&#39;), (&#39;B&#39;, &#39;doc#1&#39;), (&#39;A&#39;, &#39;doc#2&#39;), (&#39;B&#39;, &#39;doc#2&#39;), (&#39;B&#39;, &#39;doc#3&#39;), (&#39;B&#39;, &#39;doc#4&#39;)], &#39;label_terms&#39;: {&#39;A&#39;: &#39;A&#39;, &#39;B&#39;: &#39;B&#39;}, &#39;label_docs&#39;: {&#39;doc#0&#39;: 2, &#39;doc#1&#39;: 1, &#39;doc#2&#39;: 1, &#39;doc#3&#39;: 1, &#39;doc#4&#39;: 1}}</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[[</span><span class="n">column</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">})</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="n">e</span> <span class="ow">in</span> <span class="n">keywords</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)])</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>

        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span>
            <span class="p">)</span>

        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;doc-ID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;doc#</span><span class="si">{:d}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))]</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">result</span><span class="p">[[</span><span class="n">column</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">terms</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">terms</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">terms</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">terms</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">]</span>
        <span class="n">docs</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;doc-ID&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">label_docs</span> <span class="o">=</span> <span class="p">{</span><span class="n">doc</span><span class="p">:</span> <span class="n">label</span> <span class="k">for</span> <span class="n">doc</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">docs</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())}</span>
        <span class="n">label_terms</span> <span class="o">=</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">terms</span><span class="p">}</span>
        <span class="n">edges</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">docID</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">column</span><span class="p">],</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;doc-ID&quot;</span><span class="p">]):</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">:</span>
                    <span class="n">edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">item</span><span class="p">,</span> <span class="n">docID</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span>
            <span class="n">docs</span><span class="o">=</span><span class="n">docs</span><span class="p">,</span>
            <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">,</span>
            <span class="n">label_terms</span><span class="o">=</span><span class="n">label_terms</span><span class="p">,</span>
            <span class="n">label_docs</span><span class="o">=</span><span class="n">label_docs</span><span class="p">,</span>
        <span class="p">)</span></div>

    <span class="c1">#</span>
    <span class="c1">#</span>
    <span class="c1">#  Analytical functions</span>
    <span class="c1">#</span>
    <span class="c1">#</span>

<div class="viewcode-block" id="DataFrame.compute_tfm"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.compute_tfm">[docs]</a>    <span class="k">def</span> <span class="nf">compute_tfm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the term-frequency matrix for the terms in a column.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Authors&#39;)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  1  1  1  0</span>
<span class="sd">        4  0  1  0  1</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Author Keywords&#39;)</span>
<span class="sd">           a  b  c  d</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  0  0  1  0</span>
<span class="sd">        4  0  0  1  1</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">           A  B</span>
<span class="sd">        0  1  0</span>
<span class="sd">        1  1  1</span>
<span class="sd">        2  0  1</span>
<span class="sd">        3  1  1</span>
<span class="sd">        4  0  1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[[</span><span class="n">column</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">)]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s2">&quot;ID&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.autocorr"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.autocorr">[docs]</a>    <span class="k">def</span> <span class="nf">autocorr</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">,</span>
        <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the autocorrelation among items in a column of the dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            method (str): Available methods are:</span>

<span class="sd">                * pearson : Standard correlation coefficient.</span>

<span class="sd">                * kendall : Kendall Tau correlation coefficient.</span>

<span class="sd">                * spearman : Spearman rank correlation.</span>

<span class="sd">            as_matrix (bool): Results are returned as a matrix.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(column=&#39;Authors&#39;)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  1  1  1  0</span>
<span class="sd">        4  0  1  0  1</span>
<span class="sd">        5  1  1  0  0</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Authors&#39;)</span>
<span class="sd">                  A         B         C         D</span>
<span class="sd">        A  1.000000 -0.316228  0.316228 -0.632456</span>
<span class="sd">        B -0.316228  1.000000  0.200000  0.200000</span>
<span class="sd">        C  0.316228  0.200000  1.000000 -0.200000</span>
<span class="sd">        D -0.632456  0.200000 -0.200000  1.000000</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Authors&#39;, as_matrix=False)</span>
<span class="sd">           Authors (IDX) Authors (COL)     value</span>
<span class="sd">        0              A             A  1.000000</span>
<span class="sd">        1              B             A -0.316228</span>
<span class="sd">        2              C             A  0.316228</span>
<span class="sd">        3              D             A -0.632456</span>
<span class="sd">        4              A             B -0.316228</span>
<span class="sd">        5              B             B  1.000000</span>
<span class="sd">        6              C             B  0.200000</span>
<span class="sd">        7              D             B  0.200000</span>
<span class="sd">        8              A             C  0.316228</span>
<span class="sd">        9              B             C  0.200000</span>
<span class="sd">        10             C             C  1.000000</span>
<span class="sd">        11             D             C -0.200000</span>
<span class="sd">        12             A             D -0.632456</span>
<span class="sd">        13             B             D  0.200000</span>
<span class="sd">        14             C             D -0.200000</span>
<span class="sd">        15             D             D  1.000000</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Author Keywords&#39;)</span>
<span class="sd">              a     b     c     d</span>
<span class="sd">        a  1.00  0.25 -0.50 -0.50</span>
<span class="sd">        b  0.25  1.00 -0.50 -0.50</span>
<span class="sd">        c -0.50 -0.50  1.00  0.25</span>
<span class="sd">        d -0.50 -0.50  0.25  1.00</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Author Keywords&#39;, minmax=(0.25, None))</span>
<span class="sd">             a    b     c     d</span>
<span class="sd">        a  1.0  0.0  0.00  0.00</span>
<span class="sd">        b  0.0  1.0  0.00  0.00</span>
<span class="sd">        c  0.0  0.0  1.00  0.25</span>
<span class="sd">        d  0.0  0.0  0.25  1.00</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">                  A         B</span>
<span class="sd">        A  1.000000 -0.316228</span>
<span class="sd">        B -0.316228  1.000000</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tfm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_tfm</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_matrix</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                <span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">}</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
                <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">min_value</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_value</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">as_matrix</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                    <span class="n">result</span><span class="p">,</span>
                    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (IDX)&quot;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">column</span> <span class="o">+</span> <span class="s2">&quot; (COL)&quot;</span><span class="p">,</span>
                    <span class="n">fill_value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.autocorr_map"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.autocorr_map">[docs]</a>    <span class="k">def</span> <span class="nf">autocorr_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">,</span>
        <span class="n">minval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n_links</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the autocorrelation map among items in a column of the dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            method (str): Available methods are:</span>

<span class="sd">                * pearson : Standard correlation coefficient.</span>

<span class="sd">                * kendall : Kendall Tau correlation coefficient.</span>

<span class="sd">                * spearman : Spearman rank correlation.</span>

<span class="sd">            minval (float): Minimum autocorrelation value to show links.</span>
<span class="sd">            top_n_links (int): Shows top n links.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,C&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;, &#39;A,C&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,C             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>
<span class="sd">        6     A,C             c;d         6   6</span>

<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Authors&#39;)</span>
<span class="sd">                  A         B         C         D</span>
<span class="sd">        A  1.000000 -0.547723  0.547723 -0.645497</span>
<span class="sd">        B -0.547723  1.000000 -0.416667  0.353553</span>
<span class="sd">        C  0.547723 -0.416667  1.000000 -0.353553</span>
<span class="sd">        D -0.645497  0.353553 -0.353553  1.000000</span>
<span class="sd">        </span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr_map(&#39;Authors&#39;)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;], &#39;edges_75&#39;: None, &#39;edges_50&#39;: [(&#39;A&#39;, &#39;C&#39;)], &#39;edges_25&#39;: [(&#39;B&#39;, &#39;D&#39;)], &#39;other_edges&#39;: None}</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">                  A         B         C</span>
<span class="sd">        A  1.000000 -0.547723  0.547723</span>
<span class="sd">        B -0.547723  1.000000 -0.416667</span>
<span class="sd">        C  0.547723 -0.416667  1.000000</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).autocorr_map(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], &#39;edges_75&#39;: None, &#39;edges_50&#39;: [(&#39;A&#39;, &#39;C&#39;)], &#39;edges_25&#39;: None, &#39;other_edges&#39;: None}</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocorr</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">edges_75</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges_50</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges_25</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">other_edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">top_n_links</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">icol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                    <span class="n">top_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span> <span class="n">icol</span><span class="p">])</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">top_value</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="n">top_value</span><span class="p">[</span><span class="n">top_n_links</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">minval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">minval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">minval</span><span class="p">,</span> <span class="n">top_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minval</span> <span class="o">=</span> <span class="n">top_value</span>

        <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">icol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">minval</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">minval</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.75</span><span class="p">:</span>
                        <span class="n">edges_75</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.50</span><span class="p">:</span>
                        <span class="n">edges_50</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">:</span>
                        <span class="n">edges_25</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">other_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_75</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_75</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_50</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_50</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_25</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_25</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_edges</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">other_edges</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span>
            <span class="n">edges_75</span><span class="o">=</span><span class="n">edges_75</span><span class="p">,</span>
            <span class="n">edges_50</span><span class="o">=</span><span class="n">edges_50</span><span class="p">,</span>
            <span class="n">edges_25</span><span class="o">=</span><span class="n">edges_25</span><span class="p">,</span>
            <span class="n">other_edges</span><span class="o">=</span><span class="n">other_edges</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.corr"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.corr">[docs]</a>    <span class="k">def</span> <span class="nf">corr</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">,</span>
        <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the cross-correlation among items in two different columns of the dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            column_IDX (str): the first column.</span>
<span class="sd">            sep_IDX (str): Character used as internal separator for the elements in the column_IDX.</span>
<span class="sd">            column_COL (str): the second column.</span>
<span class="sd">            sep_COL (str): Character used as internal separator for the elements in the column_COL.</span>
<span class="sd">            method (str): Available methods are:</span>
<span class="sd">                </span>
<span class="sd">                - pearson : Standard correlation coefficient.</span>
<span class="sd">                </span>
<span class="sd">                - kendall : Kendall Tau correlation coefficient.</span>
<span class="sd">                </span>
<span class="sd">                - spearman : Spearman rank correlation.</span>

<span class="sd">            as_matrix (bool): the result is reshaped by melt or not.</span>
<span class="sd">            minmax (pair(number,number)): filter values by &gt;=min,&lt;=max.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>


<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Authors&#39;)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  1  1  1  0</span>
<span class="sd">        4  0  1  0  1</span>
<span class="sd">        5  1  1  0  0</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Author Keywords&#39;)</span>
<span class="sd">           a  b  c  d</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  0  0  1  0</span>
<span class="sd">        4  0  0  1  1</span>
<span class="sd">        5  0  0  0  1</span>


<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">                  A         B         C        D</span>
<span class="sd">        A  1.000000 -1.000000 -0.333333 -0.57735</span>
<span class="sd">        B -1.000000  1.000000  0.333333  0.57735</span>
<span class="sd">        C -0.333333  0.333333  1.000000  0.57735</span>
<span class="sd">        D -0.577350  0.577350  0.577350  1.00000</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;, minmax=(0.45, 0.8))</span>
<span class="sd">                 B        C        D</span>
<span class="sd">        B  0.00000  0.00000  0.57735</span>
<span class="sd">        C  0.00000  0.00000  0.57735</span>
<span class="sd">        D  0.57735  0.57735  0.00000</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;, as_matrix=False)</span>
<span class="sd">           Authors Author Keywords     value</span>
<span class="sd">        0        A               A  1.000000</span>
<span class="sd">        1        B               A -1.000000</span>
<span class="sd">        2        C               A -0.333333</span>
<span class="sd">        3        D               A -0.577350</span>
<span class="sd">        4        A               B -1.000000</span>
<span class="sd">        5        B               B  1.000000</span>
<span class="sd">        6        C               B  0.333333</span>
<span class="sd">        7        D               B  0.577350</span>
<span class="sd">        8        A               C -0.333333</span>
<span class="sd">        9        B               C  0.333333</span>
<span class="sd">        10       C               C  1.000000</span>
<span class="sd">        11       D               C  0.577350</span>
<span class="sd">        12       A               D -0.577350</span>
<span class="sd">        13       B               D  0.577350</span>
<span class="sd">        14       C               D  0.577350</span>
<span class="sd">        15       D               D  1.000000</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">                  A         B         C</span>
<span class="sd">        A  1.000000 -1.000000 -0.333333</span>
<span class="sd">        B -1.000000  1.000000  0.333333</span>
<span class="sd">        C -0.333333  0.333333  1.000000</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="n">by</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocorr</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">as_matrix</span><span class="o">=</span><span class="n">as_matrix</span><span class="p">,</span>
                <span class="n">minmax</span><span class="o">=</span><span class="n">minmax</span><span class="p">,</span>
                <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">tfm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">co_occurrence</span><span class="p">(</span>
            <span class="n">column_IDX</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
            <span class="n">column_COL</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
            <span class="n">sep_IDX</span><span class="o">=</span><span class="n">sep_by</span><span class="p">,</span>
            <span class="n">sep_COL</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
            <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">new_columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">]</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">new_index</span><span class="p">,</span> <span class="n">new_columns</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">as_matrix</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
                <span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">column</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="n">by</span><span class="p">})</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">minmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">min_value</span><span class="p">,</span> <span class="n">max_value</span> <span class="o">=</span> <span class="n">minmax</span>
                <span class="k">if</span> <span class="n">min_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">min_value</span><span class="p">)]</span>
                <span class="k">if</span> <span class="n">max_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">max_value</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">as_matrix</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                    <span class="n">result</span><span class="p">,</span>
                    <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
                    <span class="n">index</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="n">by</span><span class="p">,</span>
                    <span class="n">fill_value</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DataFrame.corr_map"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.corr_map">[docs]</a>    <span class="k">def</span> <span class="nf">corr_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">column</span><span class="p">,</span>
        <span class="n">by</span><span class="p">,</span>
        <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">sep_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pearson&quot;</span><span class="p">,</span>
        <span class="n">minval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">top_n_links</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the correlation map among items in a column of the dataframe.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            method (str): Available methods are:</span>

<span class="sd">                * pearson : Standard correlation coefficient.</span>

<span class="sd">                * kendall : Kendall Tau correlation coefficient.</span>

<span class="sd">                * spearman : Spearman rank correlation.</span>

<span class="sd">            minval (float): Minimum autocorrelation value to show links.</span>
<span class="sd">            top_n_links (int): Shows top n links.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">            </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,C&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;, &#39;A,C&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;, &#39;c;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,C             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>
<span class="sd">        6     A,C             c;d         6   6</span>


<span class="sd">        &gt;&gt;&gt; DataFrame(df).co_occurrence(&#39;Author Keywords&#39;, &#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        a  2  0  1  0</span>
<span class="sd">        b  1  1  1  0</span>
<span class="sd">        c  2  2  2  1</span>
<span class="sd">        d  2  2  1  1</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">                  A         B         C         D</span>
<span class="sd">        A  1.000000  0.174078  0.333333  0.577350</span>
<span class="sd">        B  0.174078  1.000000  0.522233  0.904534</span>
<span class="sd">        C  0.333333  0.522233  1.000000  0.577350</span>
<span class="sd">        D  0.577350  0.904534  0.577350  1.000000</span>
<span class="sd">        </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">                  A         B         C         D</span>
<span class="sd">        A  1.000000  0.174078  0.333333  0.577350</span>
<span class="sd">        B  0.174078  1.000000  0.522233  0.904534</span>
<span class="sd">        C  0.333333  0.522233  1.000000  0.577350</span>
<span class="sd">        D  0.577350  0.904534  0.577350  1.000000</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr_map(&#39;Authors&#39;, &#39;Author Keywords&#39;)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;], &#39;edges_75&#39;: None, &#39;edges_50&#39;: [(&#39;A&#39;, &#39;C&#39;)], &#39;edges_25&#39;: [(&#39;B&#39;, &#39;D&#39;)], &#39;other_edges&#39;: None}</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).corr_map(&#39;Authors&#39;, &#39;Author Keywords&#39;, keywords=keywords)</span>
<span class="sd">        {&#39;terms&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], &#39;edges_75&#39;: None, &#39;edges_50&#39;: [(&#39;A&#39;, &#39;C&#39;)], &#39;edges_25&#39;: None, &#39;other_edges&#39;: None}</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">autocorr</span><span class="p">(</span>
            <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
            <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">minmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">terms</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">edges_75</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges_50</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">edges_25</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">other_edges</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">top_n_links</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">icol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                    <span class="n">top_value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span> <span class="n">icol</span><span class="p">])</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">top_value</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">top_value</span> <span class="o">=</span> <span class="n">top_value</span><span class="p">[</span><span class="n">top_n_links</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">minval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">minval</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">minval</span><span class="p">,</span> <span class="n">top_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">minval</span> <span class="o">=</span> <span class="n">top_value</span>

        <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">icol</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">minval</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;=</span> <span class="n">minval</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.75</span><span class="p">:</span>
                        <span class="n">edges_75</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.50</span><span class="p">:</span>
                        <span class="n">edges_50</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">:</span>
                        <span class="n">edges_25</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>
                    <span class="k">elif</span> <span class="n">matrix</span><span class="p">[</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">]][</span><span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">other_edges</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">terms</span><span class="p">[</span><span class="n">icol</span><span class="p">],</span> <span class="n">terms</span><span class="p">[</span><span class="n">irow</span><span class="p">]))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_75</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_75</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_50</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_50</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">edges_25</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">edges_25</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_edges</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">other_edges</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">terms</span><span class="o">=</span><span class="n">terms</span><span class="p">,</span>
            <span class="n">edges_75</span><span class="o">=</span><span class="n">edges_75</span><span class="p">,</span>
            <span class="n">edges_50</span><span class="o">=</span><span class="n">edges_50</span><span class="p">,</span>
            <span class="n">edges_25</span><span class="o">=</span><span class="n">edges_25</span><span class="p">,</span>
            <span class="n">other_edges</span><span class="o">=</span><span class="n">other_edges</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.factor_analysis"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.factor_analysis">[docs]</a>    <span class="k">def</span> <span class="nf">factor_analysis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">as_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the matrix of factors for terms in a given column.</span>


<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            n_components: Number of components to compute.</span>
<span class="sd">            as_matrix (bool): the result is reshaped by melt or not.</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>
<span class="sd">       </span>
<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>


<span class="sd">        &gt;&gt;&gt; DataFrame(df).compute_tfm(&#39;Authors&#39;)</span>
<span class="sd">           A  B  C  D</span>
<span class="sd">        0  1  0  0  0</span>
<span class="sd">        1  1  1  0  0</span>
<span class="sd">        2  0  1  0  0</span>
<span class="sd">        3  1  1  1  0</span>
<span class="sd">        4  0  1  0  1</span>
<span class="sd">        5  1  1  0  0</span>


<span class="sd">        &gt;&gt;&gt; DataFrame(df).factor_analysis(&#39;Authors&#39;, n_components=3)</span>
<span class="sd">                 F0            F1       F2</span>
<span class="sd">        A -0.774597 -0.000000e+00  0.00000</span>
<span class="sd">        B  0.258199  7.071068e-01 -0.57735</span>
<span class="sd">        C -0.258199  7.071068e-01  0.57735</span>
<span class="sd">        D  0.516398  1.110223e-16  0.57735</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).factor_analysis(&#39;Authors&#39;, n_components=3, as_matrix=False)</span>
<span class="sd">           Authors Factor         value</span>
<span class="sd">        0        A     F0 -7.745967e-01</span>
<span class="sd">        1        B     F0  2.581989e-01</span>
<span class="sd">        2        C     F0 -2.581989e-01</span>
<span class="sd">        3        D     F0  5.163978e-01</span>
<span class="sd">        4        A     F1 -0.000000e+00</span>
<span class="sd">        5        B     F1  7.071068e-01</span>
<span class="sd">        6        C     F1  7.071068e-01</span>
<span class="sd">        7        D     F1  1.110223e-16</span>
<span class="sd">        8        A     F2  0.000000e+00</span>
<span class="sd">        9        B     F2 -5.773503e-01</span>
<span class="sd">        10       C     F2  5.773503e-01</span>
<span class="sd">        11       D     F2  5.773503e-01</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;], ignore_case=False)</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).factor_analysis(&#39;Authors&#39;, n_components=3, keywords=keywords)</span>
<span class="sd">                 F0        F1        F2</span>
<span class="sd">        A -0.888074  0.000000  0.459701</span>
<span class="sd">        B  0.325058  0.707107  0.627963</span>
<span class="sd">        C -0.325058  0.707107 -0.627963</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tfm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_tfm</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="p">)</span>
        <span class="n">terms</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n_components</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">n_components</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">terms</span><span class="p">))))</span>
        <span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_components</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">tfm</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">components_</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;F&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="n">terms</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">keywords</span><span class="o">.</span><span class="n">_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span><span class="o">.</span><span class="n">compile</span><span class="p">()</span>
            <span class="n">new_index</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">keywords</span><span class="p">]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">new_index</span><span class="p">,</span> <span class="p">:]</span>

        <span class="k">if</span> <span class="n">as_matrix</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>
            <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">column</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">:</span> <span class="s2">&quot;Factor&quot;</span><span class="p">})</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.drop_duplicates"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.drop_duplicates">[docs]</a>    <span class="k">def</span> <span class="nf">drop_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return DataFrame with duplicate rows removed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">sebset</span><span class="o">=</span><span class="n">subset</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="n">keep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.most_frequent"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.most_frequent">[docs]</a>    <span class="k">def</span> <span class="nf">most_frequent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a group for most frequent items</span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).most_frequent(&#39;Authors&#39;, top_n=1)</span>
<span class="sd">          Authors Author Keywords  Cited by  ID  top_1_Authors_freq</span>
<span class="sd">        0       A               a         0   0               False</span>
<span class="sd">        1     A,B             a;b         1   1                True</span>
<span class="sd">        2       B               b         2   2                True</span>
<span class="sd">        3   A,B,C               c         3   3                True</span>
<span class="sd">        4     B,D             c;d         4   4                True</span>
<span class="sd">        5     A,B               d         5   5                True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">Keywords</span><span class="p">()</span><span class="o">.</span><span class="n">add_keywords</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>
        <span class="n">colname</span> <span class="o">=</span> <span class="s2">&quot;top_</span><span class="si">{:d}</span><span class="s2">_</span><span class="si">{:s}</span><span class="s2">_freq&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_n</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="n">e</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)])</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.most_cited_by"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.most_cited_by">[docs]</a>    <span class="k">def</span> <span class="nf">most_cited_by</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a group for most items cited by </span>

<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; x = [ &#39;A&#39;, &#39;A,B&#39;, &#39;B&#39;, &#39;A,B,C&#39;, &#39;B,D&#39;, &#39;A,B&#39;]</span>
<span class="sd">        &gt;&gt;&gt; y = [ &#39;a&#39;, &#39;a;b&#39;, &#39;b&#39;, &#39;c&#39;, &#39;c;d&#39;, &#39;d&#39;]</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...    {</span>
<span class="sd">        ...       &#39;Authors&#39;: x,</span>
<span class="sd">        ...       &#39;Author Keywords&#39;: y,</span>
<span class="sd">        ...       &#39;Cited by&#39;: list(range(len(x))),</span>
<span class="sd">        ...       &#39;ID&#39;: list(range(len(x))),</span>
<span class="sd">        ...    }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">          Authors Author Keywords  Cited by  ID</span>
<span class="sd">        0       A               a         0   0</span>
<span class="sd">        1     A,B             a;b         1   1</span>
<span class="sd">        2       B               b         2   2</span>
<span class="sd">        3   A,B,C               c         3   3</span>
<span class="sd">        4     B,D             c;d         4   4</span>
<span class="sd">        5     A,B               d         5   5</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).most_cited_by(&#39;Authors&#39;, top_n=1)</span>
<span class="sd">          Authors Author Keywords  Cited by  ID  top_1_Authors_cited_by</span>
<span class="sd">        0       A               a         0   0                   False</span>
<span class="sd">        1     A,B             a;b         1   1                    True</span>
<span class="sd">        2       B               b         2   2                    True</span>
<span class="sd">        3   A,B,C               c         3   3                    True</span>
<span class="sd">        4     B,D             c;d         4   4                    True</span>
<span class="sd">        5     A,B               d         5   5                    True</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">citations_by_term</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">)[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">top_n</span><span class="p">)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">Keywords</span><span class="p">(</span><span class="n">keywords</span><span class="o">=</span><span class="n">top</span><span class="p">)</span>
        <span class="n">colname</span> <span class="o">=</span> <span class="s2">&quot;top_</span><span class="si">{:d}</span><span class="s2">_</span><span class="si">{:s}</span><span class="s2">_cited_by&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_n</span><span class="p">,</span> <span class="n">column</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">SCOPUS_SEPS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sep</span> <span class="o">=</span> <span class="n">SCOPUS_SEPS</span><span class="p">[</span><span class="n">column</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">sep</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
                <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="n">e</span> <span class="ow">in</span> <span class="n">items</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">sep</span><span class="p">)])</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span></div>

<div class="viewcode-block" id="DataFrame.growth_indicators"><a class="viewcode-back" href="../../dataframe.html#techminer.dataframe.DataFrame.growth_indicators">[docs]</a>    <span class="k">def</span> <span class="nf">growth_indicators</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timewindow</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Computes the average growth rate of a group of terms.</span>

<span class="sd">        Args:</span>
<span class="sd">            column (str): the column to explode.</span>
<span class="sd">            sep (str): Character used as internal separator for the elements in the column.</span>
<span class="sd">            timewindow (int): time window for analysis</span>
<span class="sd">            keywords (Keywords): filter the result using the specified Keywords object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DataFrame.</span>


<span class="sd">        Examples</span>
<span class="sd">        ----------------------------------------------------------------------------------------------</span>

<span class="sd">        &gt;&gt;&gt; import pandas as pd</span>
<span class="sd">        &gt;&gt;&gt; df = pd.DataFrame(</span>
<span class="sd">        ...     {</span>
<span class="sd">        ...          &quot;Year&quot;: [2010, 2010, 2011, 2011, 2012, 2013, 2014, 2014],</span>
<span class="sd">        ...          &quot;Authors&quot;: &quot;author 0,author 1,author 2;author 0;author 1;author 3;author 4;author 4;author 0,author 3;author 3,author 4&quot;.split(&quot;;&quot;),</span>
<span class="sd">        ...          &quot;Cited by&quot;: list(range(10,18)),</span>
<span class="sd">        ...          &quot;ID&quot;: list(range(8)),</span>
<span class="sd">        ...     }</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; df</span>
<span class="sd">           Year                     Authors  Cited by  ID</span>
<span class="sd">        0  2010  author 0,author 1,author 2        10   0</span>
<span class="sd">        1  2010                    author 0        11   1</span>
<span class="sd">        2  2011                    author 1        12   2</span>
<span class="sd">        3  2011                    author 3        13   3</span>
<span class="sd">        4  2012                    author 4        14   4</span>
<span class="sd">        5  2013                    author 4        15   5</span>
<span class="sd">        6  2014           author 0,author 3        16   6</span>
<span class="sd">        7  2014           author 3,author 4        17   7</span>

<span class="sd">        &gt;&gt;&gt; DataFrame(df).documents_by_term_per_year(&#39;Authors&#39;, as_matrix=True)</span>
<span class="sd">              author 0  author 1  author 2  author 3  author 4</span>
<span class="sd">        2010         2         1         1         0         0</span>
<span class="sd">        2011         0         1         0         1         0</span>
<span class="sd">        2012         0         0         0         0         1</span>
<span class="sd">        2013         0         0         0         0         1</span>
<span class="sd">        2014         1         0         0         2         1</span>
<span class="sd">    </span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).growth_indicators(&#39;Authors&#39;)</span>
<span class="sd">            Authors       AGR  ADY   PDLY  Before 2013  Between 2013-2014</span>
<span class="sd">        0  author 3  0.666667  1.0  12.50            1                  2</span>
<span class="sd">        1  author 0  0.333333  0.5   6.25            2                  1</span>
<span class="sd">        2  author 4  0.000000  1.0  12.50            1                  2</span>

<span class="sd">        &gt;&gt;&gt; keywords = Keywords([&#39;author 3&#39;, &#39;author 4&#39;])</span>
<span class="sd">        &gt;&gt;&gt; keywords = keywords.compile()</span>
<span class="sd">        &gt;&gt;&gt; DataFrame(df).growth_indicators(&#39;Authors&#39;, keywords=keywords)</span>
<span class="sd">            Authors       AGR  ADY  PDLY  Before 2013  Between 2013-2014</span>
<span class="sd">        0  author 3  0.666667  1.0  12.5            1                  2</span>
<span class="sd">        1  author 4  0.000000  1.0  12.5            1                  2</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">compute_agr</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term_per_year</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span>
            <span class="p">)</span>
            <span class="n">years_agr</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="p">))[</span><span class="o">-</span><span class="p">(</span><span class="n">timewindow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:]</span>
            <span class="n">years_agr</span> <span class="o">=</span> <span class="p">[</span><span class="n">years_agr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">years_agr</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">years_agr</span><span class="p">)]</span>
            <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ID&quot;</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;Year&quot;</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">column</span><span class="p">,</span>
                <span class="n">values</span><span class="o">=</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">,</span>
                <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;AGR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
                <span class="n">AGR</span><span class="o">=</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="n">years_agr</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">result</span><span class="p">[</span><span class="n">years_agr</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">/</span> <span class="p">(</span><span class="n">timewindow</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">years_agr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">result</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">years_agr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;AGR&quot;</span><span class="p">,</span> <span class="n">column</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">def</span> <span class="nf">compute_ady</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term_per_year</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span>
            <span class="p">)</span>
            <span class="n">years_ady</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="p">))[</span><span class="o">-</span><span class="n">timewindow</span><span class="p">:]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">years_ady</span><span class="p">)]</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="s2">&quot;ADY&quot;</span><span class="p">})</span>
            <span class="n">result</span><span class="p">[</span><span class="s2">&quot;ADY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">ADY</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="o">/</span> <span class="n">timewindow</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">ADY</span>

        <span class="k">def</span> <span class="nf">compute_num_documents</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">documents_by_term_per_year</span><span class="p">(</span>
                <span class="n">column</span><span class="o">=</span><span class="n">column</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="n">sep</span><span class="p">,</span> <span class="n">keywords</span><span class="o">=</span><span class="n">keywords</span>
            <span class="p">)</span>
            <span class="n">years_between</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="p">))[</span><span class="o">-</span><span class="n">timewindow</span><span class="p">:]</span>
            <span class="n">years_before</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="p">))[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="n">timewindow</span><span class="p">]</span>
            <span class="n">between</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">years_between</span><span class="p">)]</span>
            <span class="n">before</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">years_before</span><span class="p">)]</span>
            <span class="n">between</span> <span class="o">=</span> <span class="n">between</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="n">between</span> <span class="o">=</span> <span class="n">between</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="s2">&quot;Between </span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">years_between</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">years_between</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">before</span> <span class="o">=</span> <span class="n">before</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">column</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
                <span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="n">before</span> <span class="o">=</span> <span class="n">before</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Num Documents&quot;</span><span class="p">:</span> <span class="s2">&quot;Before </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">years_between</span><span class="p">[</span><span class="mi">0</span><span class="p">])}</span>
            <span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">before</span><span class="p">,</span> <span class="n">between</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">compute_agr</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>
        <span class="n">ady</span> <span class="o">=</span> <span class="n">compute_ady</span><span class="p">()</span>
        <span class="n">result</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">ady</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s2">&quot;ADY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ady</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">PDLY</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">ADY</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">num_docs</span> <span class="o">=</span> <span class="n">compute_num_documents</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">num_docs</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">column</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span></div></div>


<span class="c1"># result =</span>
<span class="c1">#     Authors  Year  Num Documents      ID</span>
<span class="c1"># 0  author 0  2010              2  [0, 1]</span>
<span class="c1"># 1  author 1  2010              1     [0]</span>
<span class="c1"># 2  author 2  2010              1     [0]</span>
<span class="c1"># 3  author 1  2011              1     [2]</span>
<span class="c1"># 4  author 3  2011              1     [3]</span>
<span class="c1"># 5  author 4  2012              1     [4]</span>
<span class="c1"># 6  author 4  2013              1     [5]</span>
<span class="c1"># 7  author 3  2014              2  [6, 7]</span>
<span class="c1"># 8  author 4  2014              1     [7]</span>

<span class="c1"># def __getitem__(self, key):</span>
<span class="c1">#     return DataFrame(super().__getitem__(key))</span>

<span class="c1"># def _getitem_bool_array(self, key):</span>
<span class="c1">#     return DataFrame(super()._getitem_bool_array(key))</span>

<span class="c1"># def _getitem_multilevel(self, key):</span>
<span class="c1">#     return DataFrame(super()._getitem_multilevel(key))</span>

<span class="c1"># def _get_column_array(self, i):</span>
<span class="c1">#     return DataFrame(super()._get_column_array(i))</span>

<span class="c1"># def assign(self, **kwargs):</span>
<span class="c1">#     return DataFrame(super().assign(**kwargs))</span>

<span class="c1"># def test(self):</span>
<span class="c1">#     &quot;&quot;&quot;</span>

<span class="c1">#     &gt;&gt;&gt; import pandas as pd</span>
<span class="c1">#     &gt;&gt;&gt; pd = pd.DataFrame(</span>
<span class="c1">#     ...     {</span>
<span class="c1">#     ...         &quot;Authors&quot;: &quot;author 3,author 1,author 0,author 2&quot;.split(&quot;,&quot;),</span>
<span class="c1">#     ...         &quot;Num Documents&quot;: [10, 5, 2, 1],</span>
<span class="c1">#     ...         &quot;ID&quot;: list(range(4)),</span>
<span class="c1">#     ...     }</span>
<span class="c1">#     ... )</span>
<span class="c1">#     &gt;&gt;&gt; pd = DataFrame(pd)</span>
<span class="c1">#     &gt;&gt;&gt; type(pd)</span>
<span class="c1">#     &lt;class &#39;techminer.dataframe.DataFrame&#39;&gt;</span>

<span class="c1">#     &gt;&gt;&gt; type(pd[[True, True, False, False]])</span>
<span class="c1">#     &lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</span>

<span class="c1">#     # &gt;&gt;&gt; pd[[True, True, False, False]]</span>

<span class="c1">#     &quot;&quot;&quot;</span>

<span class="c1">#     pass</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>

    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>